import scrapy
import json


class TripAdvisor(scrapy.Spider):
    name = 'trip_reviews2'

    payload = "[{\"query\":\"mutation LogBBMLInteraction($interaction: ClientInteractionOpaqueInput!) {\\n  logProductInteraction(interaction: $interaction)\\n}\\n\",\"variables\":{\"interaction\":{\"productInteraction\":{\"interaction_type\":\"CLICK\",\"site\":{\"site_name\":\"ta\",\"site_business_unit\":\"Flights\",\"site_domain\":\"www.tripadvisor.com\"},\"pageview\":{\"pageview_request_uid\":\"XgDaJwokHn4AAB@IbjkAAAEH\",\"pageview_attributes\":{\"location_id\":8729060,\"geo_id\":1,\"servlet_name\":\"Airline_Review\"}},\"user\":{\"user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36\",\"site_persistent_user_uid\":\"web422a.105.105.168.58.16ED1C5BCB1\",\"unique_user_identifiers\":{\"session_id\":\"74588AE01C212E5515DA325C2384A739\"}},\"search\":{},\"item_group\":{\"item_group_collection_key\":\"XgDaJwokHn4AAB@IbjkAAAEH\"},\"item\":{\"product_type\":\"Flights\",\"item_id_type\":\"ta-location-id\",\"item_id\":8729060,\"item_attributes\":{\"element_type\":\"next\",\"action_name\":\"REVIEW_NAV\",\"page_number\":null,\"offset\":null,\"limit\":5}}}}}},{\"query\":\"query ReviewListQuery($locationId: Int!, $offset: Int, $limit: Int, $filters: [FilterConditionInput!], $prefs: ReviewListPrefsInput, $initialPrefs: ReviewListPrefsInput, $filterCacheKey: String, $prefsCacheKey: String, $keywordVariant: String!, $needKeywords: Boolean = true) {\\n  cachedFilters: personalCache(key: $filterCacheKey)\\n  cachedPrefs: personalCache(key: $prefsCacheKey)\\n  locations(locationIds: [$locationId]) {\\n    locationId\\n    parentGeoId\\n    name\\n    placeType\\n    reviewSummary {\\n      rating\\n      count\\n    }\\n    keywords(variant: $keywordVariant) @include(if: $needKeywords) {\\n      keywords {\\n        keyword\\n      }\\n    }\\n    ... on LocationInformation {\\n      parentGeoId\\n    }\\n    ... on LocationInformation {\\n      parentGeoId\\n    }\\n    ... on LocationInformation {\\n      name\\n      currentUserOwnerStatus {\\n        isValid\\n      }\\n    }\\n    ... on LocationInformation {\\n      locationId\\n      currentUserOwnerStatus {\\n        isValid\\n      }\\n    }\\n    ... on LocationInformation {\\n      locationId\\n      parentGeoId\\n      accommodationCategory\\n      currentUserOwnerStatus {\\n        isValid\\n      }\\n      url\\n    }\\n    reviewListPage(page: {offset: $offset, limit: $limit}, filters: $filters, prefs: $prefs, initialPrefs: $initialPrefs, filterCacheKey: $filterCacheKey, prefsCacheKey: $prefsCacheKey) {\\n      totalCount\\n      preferredReviewIds\\n      reviews {\\n        ... on Review {\\n          id\\n          url\\n          location {\\n            locationId\\n            name\\n          }\\n          createdDate\\n          publishedDate\\n          provider {\\n            isLocalProvider\\n          }\\n          userProfile {\\n            id\\n            userId: id\\n            isMe\\n            isVerified\\n            displayName\\n            username\\n            avatar {\\n              id\\n              photoSizes {\\n                url\\n                width\\n                height\\n              }\\n            }\\n            hometown {\\n              locationId\\n              fallbackString\\n              location {\\n                locationId\\n                additionalNames {\\n                  long\\n                }\\n                name\\n              }\\n            }\\n            contributionCounts {\\n              sumAllUgc\\n              helpfulVote\\n            }\\n            route {\\n              url\\n            }\\n          }\\n        }\\n        ... on Review {\\n          title\\n          language\\n          url\\n        }\\n        ... on Review {\\n          language\\n          translationType\\n        }\\n        ... on Review {\\n          roomTip\\n        }\\n        ... on Review {\\n          tripInfo {\\n            stayDate\\n          }\\n          location {\\n            placeType\\n          }\\n        }\\n        ... on Review {\\n          tripInfo {\\n            stayDate\\n          }\\n          location {\\n            placeType\\n          }\\n        }\\n        ... on Review {\\n          additionalRatings {\\n            rating\\n            ratingLabel\\n          }\\n        }\\n        ... on Review {\\n          tripInfo {\\n            tripType\\n          }\\n        }\\n        ... on Review {\\n          language\\n          translationType\\n          mgmtResponse {\\n            id\\n            language\\n            translationType\\n          }\\n        }\\n        ... on Review {\\n          text\\n          publishedDate\\n          username\\n          connectionToSubject\\n          language\\n          mgmtResponse {\\n            id\\n            text\\n            language\\n            publishedDate\\n            username\\n            connectionToSubject\\n          }\\n        }\\n        ... on Review {\\n          id\\n          locationId\\n          title\\n          text\\n          rating\\n          absoluteUrl\\n          mcid\\n          translationType\\n          mtProviderId\\n          photos {\\n            id\\n            statuses\\n            photoSizes {\\n              url\\n              width\\n              height\\n            }\\n          }\\n          userProfile {\\n            id\\n            displayName\\n            username\\n          }\\n        }\\n        ... on Review {\\n          mgmtResponse {\\n            id\\n          }\\n          provider {\\n            isLocalProvider\\n          }\\n        }\\n        ... on Review {\\n          translationType\\n          location {\\n            locationId\\n            parentGeoId\\n          }\\n          provider {\\n            isLocalProvider\\n            isToolsProvider\\n          }\\n          original {\\n            id\\n            url\\n            locationId\\n            userId\\n            language\\n            submissionDomain\\n          }\\n        }\\n        ... on Review {\\n          locationId\\n          mcid\\n          attribution\\n        }\\n        ... on Review {\\n          __typename\\n          locationId\\n          helpfulVotes\\n          photoIds\\n          route {\\n            url\\n          }\\n          socialStatistics {\\n            followCount\\n            isFollowing\\n            isLiked\\n            isReposted\\n            isSaved\\n            likeCount\\n            repostCount\\n            tripCount\\n          }\\n          status\\n          userId\\n          userProfile {\\n            id\\n            displayName\\n            isFollowing\\n          }\\n          location {\\n            __typename\\n            locationId\\n            additionalNames {\\n              normal\\n              long\\n              longOnlyParent\\n              longParentAbbreviated\\n              longOnlyParentAbbreviated\\n              longParentStateAbbreviated\\n              longOnlyParentStateAbbreviated\\n              geo\\n              abbreviated\\n              abbreviatedRaw\\n              abbreviatedStateTerritory\\n              abbreviatedStateTerritoryRaw\\n            }\\n            parent {\\n              locationId\\n              additionalNames {\\n                normal\\n                long\\n                longOnlyParent\\n                longParentAbbreviated\\n                longOnlyParentAbbreviated\\n                longParentStateAbbreviated\\n                longOnlyParentStateAbbreviated\\n                geo\\n                abbreviated\\n                abbreviatedRaw\\n                abbreviatedStateTerritory\\n                abbreviatedStateTerritoryRaw\\n              }\\n            }\\n          }\\n        }\\n        ... on Review {\\n          text\\n          language\\n        }\\n        ... on Review {\\n          locationId\\n          absoluteUrl\\n          mcid\\n          translationType\\n          mtProviderId\\n          originalLanguage\\n          rating\\n        }\\n        ... on Review {\\n          id\\n          locationId\\n          title\\n          labels\\n          rating\\n          absoluteUrl\\n          mcid\\n          translationType\\n          mtProviderId\\n          alertStatus\\n        }\\n      }\\n    }\\n    reviewAggregations {\\n      ratingCounts\\n      languageCounts\\n      alertStatusCount\\n    }\\n  }\\n}\\n\",\"variables\":{\"locationId\":8729060,\"offset\":10,\"filters\":[{\"axis\":\"LANGUAGE\",\"selections\":[\"en\"]}],\"prefs\":null,\"initialPrefs\":{},\"limit\":5,\"filterCacheKey\":null,\"prefsCacheKey\":\"locationReviewPrefs\",\"needKeywords\":false,\"keywordVariant\":\"location_keywords_v2_llr_order_30_en\"}}]"
    i =2 
    j =5

    def start_requests(self):
        yield scrapy.Request(
            url='https://www.tripadvisor.com/data/graphql/batched',
            method='POST',

        
            headers={
                'Content-Type': 'application/json',
                'x-requested-by': 'TNI1625!AGv2HQOyCMQoSZS9gud1n2nx47d0DLlzKpUNV7Q7wZSPtXoXIXT3E1zWVZagDvDOjyrB0YVIfpzu5qgVz/Seys09kALdhcByVFVQ0flAXKv6NhX3vGNpFnk6dMnMjCjQI5oU6qO75qZ5bFhkYBw2p1yEuKoCReJ995zjzxBEGCAF',
                'cookie': 'ServerPool=C; TAUnique=%1%enc%3A4j5DAVlKJT%2BGq86ycFrXBkillTiK2NnMFyPAAu%2B%2Bj9%2FiJ6g91gwMNg%3D%3D; TASSK=enc%3AAFvLhk103gQnUUpgysgKCtvdCXvFFHoR9R93UmWK3owItJQ3ULpZeavdg%2B8PK%2B3iROmQuZlHTn%2BgCAnpfywHr0g4bO5NVWHmXJm06MRhlxsa4cKhdE4blywKTvTfHc2w3Q%3D%3D; TAPD=tripadvisor.com; VRMCID=%1%V1*id.10568*llp.%2FAirline_Review-d8729060-Reviews-Delta-Air-Lines*e.1577581099798; TART=%1%enc%3AYV7FTnAUbTifMPDmjzpuak41wAKzT4WwlhABxmDUNrUrpSvXPh2F8JXG7D6%2BAmqiftjoAd77q%2FU%3D; TATravelInfo=V2*AY.2020*AM.1*AD.5*DY.2020*DM.1*DD.6*A.2*MG.-1*HP.2*FL.3*DSM.1577063222735*RS.1; TADCID=CX-zKtjjIwwOODMyABQC5UI2n8iqRdCoS-RMXjJFU1pk5m9oi1Rk5JzfJfa7_RBFYZblN38mIA8jBm95cvcwM7-cZEC-wJiJx0g; __vt=tRGsMR5DIMr-j2ptABQCKh0bQ-d8T96qptG7UVr_ZQpChvq3JWmcQH5BX4BDZfyzguPIId_fq5zVtzarZSbh2IVTE648dwndidXHABbuSP6-T5ihSgneRmRqGnHFuHw_lGqQVtVWzMgP3ngFCx1stND0; PAC=ALeyTK4ITMP18gTEc3rSRclBNZd-HFiU-j__cGrbyHXjqXqsYT5uw6iBXydTTfszbP5HRKOtfc8TTdVGCPcXaL0GcL8GqIfFCQHPWoHm9RDxcT1orsY8zj--9ypl36X5pA%3D%3D; PMC=V2*MS.80*MD.20191217*LD.20191227; CM=%1%PremiumMobSess%2C%2C-1%7Ct4b-pc%2C%2C-1%7CRestAds%2FRPers%2C%2C-1%7CRCPers%2C%2C-1%7CWShadeSeen%2C%2C-1%7CTheForkMCCPers%2C%2C-1%7CHomeASess%2C9%2C-1%7CPremiumSURPers%2C%2C-1%7Ctvsess%2C1%2C-1%7CPremiumMCSess%2C%2C-1%7CUVOwnersSess%2C%2C-1%7CRestPremRSess%2C%2C-1%7CCCSess%2C%2C-1%7CCYLSess%2C%2C-1%7CPremRetPers%2C%2C-1%7CViatorMCPers%2C%2C-1%7Csesssticker%2C%2C-1%7CPremiumORSess%2C%2C-1%7Ct4b-sc%2C%2C-1%7CRestAdsPers%2C%2C-1%7CMC_IB_UPSELL_IB_LOGOS2%2C%2C-1%7Cb2bmcpers%2C%2C-1%7CPremMCBtmSess%2C%2C-1%7CPremiumSURSess%2C%2C-1%7CMC_IB_UPSELL_IB_LOGOS%2C%2C-1%7CLaFourchette+Banners%2C%2C-1%7Csess_rev%2C%2C-1%7Csessamex%2C%2C-1%7CPremiumRRSess%2C%2C-1%7CTADORSess%2C%2C-1%7CAdsRetPers%2C%2C-1%7CTARSWBPers%2C%2C-1%7CSPMCSess%2C%2C-1%7CTheForkORSess%2C%2C-1%7CTheForkRRSess%2C%2C-1%7Cpers_rev%2C%2C-1%7CSPMCWBPers%2C%2C-1%7CRBAPers%2C%2C-1%7CRestAds%2FRSess%2C%2C-1%7CHomeAPers%2C%2C-1%7CPremiumMobPers%2C%2C-1%7CRCSess%2C%2C-1%7CLaFourchette+MC+Banners%2C%2C-1%7CRestAdsCCSess%2C%2C-1%7CRestPremRPers%2C%2C-1%7CRevHubRMPers%2C%2C-1%7CUVOwnersPers%2C%2C-1%7Csh%2C%2C-1%7Cpssamex%2C%2C-1%7CTheForkMCCSess%2C%2C-1%7CCYLPers%2C%2C-1%7CCCPers%2C%2C-1%7Ctvpers%2C%2C-1%7Cb2bmcsess%2C%2C-1%7CSPMCPers%2C%2C-1%7CRevHubRMSess%2C%2C-1%7CPremRetSess%2C%2C-1%7CViatorMCSess%2C%2C-1%7CPremiumMCPers%2C%2C-1%7CAdsRetSess%2C%2C-1%7CPremiumRRPers%2C%2C-1%7CRestAdsCCPers%2C%2C-1%7CTADORPers%2C%2C-1%7CTheForkORPers%2C%2C-1%7CPremMCBtmPers%2C%2C-1%7CTheForkRRPers%2C%2C-1%7CTARSWBSess%2C%2C-1%7CPremiumORPers%2C%2C-1%7CRestAdsSess%2C%2C-1%7CRBASess%2C%2C-1%7CSPORPers%2C%2C-1%7Cperssticker%2C%2C-1%7CSPMCWBSess%2C%2C-1%7C; TAReturnTo=%1%%2FAirline_Review-d8729060-Reviews-Delta-Air-Lines; roybatty=TNI1625!AIBH5WivmwQLLHnyUY%2FZTiEpq%2BOfkSol3T1j16PzoW1VqBR6yaPrLNdc4wDaf%2Bwos5%2BLBpD4KtDiq4v3in%2BI%2FlqXsFEameXwmkQUcvl9A5sf2DXqTWp4lzDpN7squYchnHWgB5zfTBrNAEPwG%2F1tsL%2FacVJg6yMcVW%2Fxz%2F2%2BwpRh%2C1; TASession=V2ID.238E1A99E3396899FAD6EF87ADAD9D27*SQ.82*LS.DemandLoadAjax*GR.42*TCPAR.42*TBR.61*EXEX.45*ABTR.91*PHTB.98*FS.6*CPU.24*HS.recommended*ES.popularity*DS.5*SAS.popularity*FPS.oldFirst*LF.en*FA.1*DF.0*IR.3*OD.en_UK*TRA.false*LD.8729060; TAUD=LA-1576625194436-1*RDD-1-2019_12_17*HC-400655150*HDD-438028237-2020_01_05.2020_01_06*LG-833009317-2.1.F.*LD-833009318-.....',
            },
            body=self.payload,
            callback=self.parse,
        )

    def parse(self, response):
        json_response = json.loads(response.body)
        reviews = json_response[1].get('data').get('locations')[0].get('reviewListPage').get('reviews')
        for review in reviews:
            yield {
                'review_text': review.get('text'),
                'username': review.get('username'),
                'title': review.get('title'),
                'route': review.get('labels')[0],
                'class': review.get('labels')[2],
                'publishedDate': review.get('publishedDate')
            }
        
        new_payload = "[{\"query\":\"mutation LogBBMLInteraction($interaction: ClientInteractionOpaqueInput!) {\\n  logProductInteraction(interaction: $interaction)\\n}\\n\",\"variables\":{\"interaction\":{\"productInteraction\":{\"interaction_type\":\"CLICK\",\"site\":{\"site_name\":\"ta\",\"site_business_unit\":\"Flights\",\"site_domain\":\"www.tripadvisor.com\"},\"pageview\":{\"pageview_request_uid\":\"XgDaJwokHn4AAB@IbjkAAAEH\",\"pageview_attributes\":{\"location_id\":8729060,\"geo_id\":1,\"servlet_name\":\"Airline_Review\"}},\"user\":{\"user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36\",\"site_persistent_user_uid\":\"web422a.105.105.168.58.16ED1C5BCB1\",\"unique_user_identifiers\":{\"session_id\":\"74588AE01C212E5515DA325C2384A739\"}},\"search\":{},\"item_group\":{\"item_group_collection_key\":\"XgDaJwokHn4AAB@IbjkAAAEH\"},\"item\":{\"product_type\":\"Flights\",\"item_id_type\":\"ta-location-id\",\"item_id\":8729060,\"item_attributes\":{\"element_type\":\"next\",\"action_name\":\"REVIEW_NAV\",\"page_number\":2,\"offset\":5,\"limit\":5}}}}}},{\"query\":\"query ReviewListQuery($locationId: Int!, $offset: Int, $limit: Int, $filters: [FilterConditionInput!], $prefs: ReviewListPrefsInput, $initialPrefs: ReviewListPrefsInput, $filterCacheKey: String, $prefsCacheKey: String, $keywordVariant: String!, $needKeywords: Boolean = true) {\\n  cachedFilters: personalCache(key: $filterCacheKey)\\n  cachedPrefs: personalCache(key: $prefsCacheKey)\\n  locations(locationIds: [$locationId]) {\\n    locationId\\n    parentGeoId\\n    name\\n    placeType\\n    reviewSummary {\\n      rating\\n      count\\n    }\\n    keywords(variant: $keywordVariant) @include(if: $needKeywords) {\\n      keywords {\\n        keyword\\n      }\\n    }\\n    ... on LocationInformation {\\n      parentGeoId\\n    }\\n    ... on LocationInformation {\\n      parentGeoId\\n    }\\n    ... on LocationInformation {\\n      name\\n      currentUserOwnerStatus {\\n        isValid\\n      }\\n    }\\n    ... on LocationInformation {\\n      locationId\\n      currentUserOwnerStatus {\\n        isValid\\n      }\\n    }\\n    ... on LocationInformation {\\n      locationId\\n      parentGeoId\\n      accommodationCategory\\n      currentUserOwnerStatus {\\n        isValid\\n      }\\n      url\\n    }\\n    reviewListPage(page: {offset: $offset, limit: $limit}, filters: $filters, prefs: $prefs, initialPrefs: $initialPrefs, filterCacheKey: $filterCacheKey, prefsCacheKey: $prefsCacheKey) {\\n      totalCount\\n      preferredReviewIds\\n      reviews {\\n        ... on Review {\\n          id\\n          url\\n          location {\\n            locationId\\n            name\\n          }\\n          createdDate\\n          publishedDate\\n          provider {\\n            isLocalProvider\\n          }\\n          userProfile {\\n            id\\n            userId: id\\n            isMe\\n            isVerified\\n            displayName\\n            username\\n            avatar {\\n              id\\n              photoSizes {\\n                url\\n                width\\n                height\\n              }\\n            }\\n            hometown {\\n              locationId\\n              fallbackString\\n              location {\\n                locationId\\n                additionalNames {\\n                  long\\n                }\\n                name\\n              }\\n            }\\n            contributionCounts {\\n              sumAllUgc\\n              helpfulVote\\n            }\\n            route {\\n              url\\n            }\\n          }\\n        }\\n        ... on Review {\\n          title\\n          language\\n          url\\n        }\\n        ... on Review {\\n          language\\n          translationType\\n        }\\n        ... on Review {\\n          roomTip\\n        }\\n        ... on Review {\\n          tripInfo {\\n            stayDate\\n          }\\n          location {\\n            placeType\\n          }\\n        }\\n        ... on Review {\\n          tripInfo {\\n            stayDate\\n          }\\n          location {\\n            placeType\\n          }\\n        }\\n        ... on Review {\\n          additionalRatings {\\n            rating\\n            ratingLabel\\n          }\\n        }\\n        ... on Review {\\n          tripInfo {\\n            tripType\\n          }\\n        }\\n        ... on Review {\\n          language\\n          translationType\\n          mgmtResponse {\\n            id\\n            language\\n            translationType\\n          }\\n        }\\n        ... on Review {\\n          text\\n          publishedDate\\n          username\\n          connectionToSubject\\n          language\\n          mgmtResponse {\\n            id\\n            text\\n            language\\n            publishedDate\\n            username\\n            connectionToSubject\\n          }\\n        }\\n        ... on Review {\\n          id\\n          locationId\\n          title\\n          text\\n          rating\\n          absoluteUrl\\n          mcid\\n          translationType\\n          mtProviderId\\n          photos {\\n            id\\n            statuses\\n            photoSizes {\\n              url\\n              width\\n              height\\n            }\\n          }\\n          userProfile {\\n            id\\n            displayName\\n            username\\n          }\\n        }\\n        ... on Review {\\n          mgmtResponse {\\n            id\\n          }\\n          provider {\\n            isLocalProvider\\n          }\\n        }\\n        ... on Review {\\n          translationType\\n          location {\\n            locationId\\n            parentGeoId\\n          }\\n          provider {\\n            isLocalProvider\\n            isToolsProvider\\n          }\\n          original {\\n            id\\n            url\\n            locationId\\n            userId\\n            language\\n            submissionDomain\\n          }\\n        }\\n        ... on Review {\\n          locationId\\n          mcid\\n          attribution\\n        }\\n        ... on Review {\\n          __typename\\n          locationId\\n          helpfulVotes\\n          photoIds\\n          route {\\n            url\\n          }\\n          socialStatistics {\\n            followCount\\n            isFollowing\\n            isLiked\\n            isReposted\\n            isSaved\\n            likeCount\\n            repostCount\\n            tripCount\\n          }\\n          status\\n          userId\\n          userProfile {\\n            id\\n            displayName\\n            isFollowing\\n          }\\n          location {\\n            __typename\\n            locationId\\n            additionalNames {\\n              normal\\n              long\\n              longOnlyParent\\n              longParentAbbreviated\\n              longOnlyParentAbbreviated\\n              longParentStateAbbreviated\\n              longOnlyParentStateAbbreviated\\n              geo\\n              abbreviated\\n              abbreviatedRaw\\n              abbreviatedStateTerritory\\n              abbreviatedStateTerritoryRaw\\n            }\\n            parent {\\n              locationId\\n              additionalNames {\\n                normal\\n                long\\n                longOnlyParent\\n                longParentAbbreviated\\n                longOnlyParentAbbreviated\\n                longParentStateAbbreviated\\n                longOnlyParentStateAbbreviated\\n                geo\\n                abbreviated\\n                abbreviatedRaw\\n                abbreviatedStateTerritory\\n                abbreviatedStateTerritoryRaw\\n              }\\n            }\\n          }\\n        }\\n        ... on Review {\\n          text\\n          language\\n        }\\n        ... on Review {\\n          locationId\\n          absoluteUrl\\n          mcid\\n          translationType\\n          mtProviderId\\n          originalLanguage\\n          rating\\n        }\\n        ... on Review {\\n          id\\n          locationId\\n          title\\n          labels\\n          rating\\n          absoluteUrl\\n          mcid\\n          translationType\\n          mtProviderId\\n          alertStatus\\n        }\\n      }\\n    }\\n    reviewAggregations {\\n      ratingCounts\\n      languageCounts\\n      alertStatusCount\\n    }\\n  }\\n}\\n\",\"variables\":{\"locationId\":8729060,\"offset\":10,\"filters\":[{\"axis\":\"LANGUAGE\",\"selections\":[\"en\"]}],\"prefs\":null,\"initialPrefs\":{},\"limit\":5,\"filterCacheKey\":null,\"prefsCacheKey\":\"locationReviewPrefs\",\"needKeywords\":false,\"keywordVariant\":\"location_keywords_v2_llr_order_30_en\"}}]"
    
        if self.i <=25:
            new_payload = json.loads(new_payload)
            new_payload[0]['variables']['interaction']['productInteraction']['item']['item_attributes']['page_number']=self.i
            new_payload[0]['variables']['interaction']['productInteraction']['item']['item_attributes']['offset']=self.j
            self.i += 1
            self.j += 5
            yield scrapy.Request(url='https://www.tripadvisor.com/data/graphql/batched',
                                method='POST',
                                headers={
                                'Content-Type': 'application/json',
                                'x-requested-by': 'TNI1625!AGv2HQOyCMQoSZS9gud1n2nx47d0DLlzKpUNV7Q7wZSPtXoXIXT3E1zWVZagDvDOjyrB0YVIfpzu5qgVz/Seys09kALdhcByVFVQ0flAXKv6NhX3vGNpFnk6dMnMjCjQI5oU6qO75qZ5bFhkYBw2p1yEuKoCReJ995zjzxBEGCAF',
                                'cookie': 'ServerPool=C; TAUnique=%1%enc%3A4j5DAVlKJT%2BGq86ycFrXBkillTiK2NnMFyPAAu%2B%2Bj9%2FiJ6g91gwMNg%3D%3D; TASSK=enc%3AAFvLhk103gQnUUpgysgKCtvdCXvFFHoR9R93UmWK3owItJQ3ULpZeavdg%2B8PK%2B3iROmQuZlHTn%2BgCAnpfywHr0g4bO5NVWHmXJm06MRhlxsa4cKhdE4blywKTvTfHc2w3Q%3D%3D; TAPD=tripadvisor.com; VRMCID=%1%V1*id.10568*llp.%2FAirline_Review-d8729060-Reviews-Delta-Air-Lines*e.1577581099798; TART=%1%enc%3AYV7FTnAUbTifMPDmjzpuak41wAKzT4WwlhABxmDUNrUrpSvXPh2F8JXG7D6%2BAmqiftjoAd77q%2FU%3D; TATravelInfo=V2*AY.2020*AM.1*AD.5*DY.2020*DM.1*DD.6*A.2*MG.-1*HP.2*FL.3*DSM.1577063222735*RS.1; TADCID=CX-zKtjjIwwOODMyABQC5UI2n8iqRdCoS-RMXjJFU1pk5m9oi1Rk5JzfJfa7_RBFYZblN38mIA8jBm95cvcwM7-cZEC-wJiJx0g; __vt=tRGsMR5DIMr-j2ptABQCKh0bQ-d8T96qptG7UVr_ZQpChvq3JWmcQH5BX4BDZfyzguPIId_fq5zVtzarZSbh2IVTE648dwndidXHABbuSP6-T5ihSgneRmRqGnHFuHw_lGqQVtVWzMgP3ngFCx1stND0; PAC=ALeyTK4ITMP18gTEc3rSRclBNZd-HFiU-j__cGrbyHXjqXqsYT5uw6iBXydTTfszbP5HRKOtfc8TTdVGCPcXaL0GcL8GqIfFCQHPWoHm9RDxcT1orsY8zj--9ypl36X5pA%3D%3D; PMC=V2*MS.80*MD.20191217*LD.20191227; CM=%1%PremiumMobSess%2C%2C-1%7Ct4b-pc%2C%2C-1%7CRestAds%2FRPers%2C%2C-1%7CRCPers%2C%2C-1%7CWShadeSeen%2C%2C-1%7CTheForkMCCPers%2C%2C-1%7CHomeASess%2C9%2C-1%7CPremiumSURPers%2C%2C-1%7Ctvsess%2C1%2C-1%7CPremiumMCSess%2C%2C-1%7CUVOwnersSess%2C%2C-1%7CRestPremRSess%2C%2C-1%7CCCSess%2C%2C-1%7CCYLSess%2C%2C-1%7CPremRetPers%2C%2C-1%7CViatorMCPers%2C%2C-1%7Csesssticker%2C%2C-1%7CPremiumORSess%2C%2C-1%7Ct4b-sc%2C%2C-1%7CRestAdsPers%2C%2C-1%7CMC_IB_UPSELL_IB_LOGOS2%2C%2C-1%7Cb2bmcpers%2C%2C-1%7CPremMCBtmSess%2C%2C-1%7CPremiumSURSess%2C%2C-1%7CMC_IB_UPSELL_IB_LOGOS%2C%2C-1%7CLaFourchette+Banners%2C%2C-1%7Csess_rev%2C%2C-1%7Csessamex%2C%2C-1%7CPremiumRRSess%2C%2C-1%7CTADORSess%2C%2C-1%7CAdsRetPers%2C%2C-1%7CTARSWBPers%2C%2C-1%7CSPMCSess%2C%2C-1%7CTheForkORSess%2C%2C-1%7CTheForkRRSess%2C%2C-1%7Cpers_rev%2C%2C-1%7CSPMCWBPers%2C%2C-1%7CRBAPers%2C%2C-1%7CRestAds%2FRSess%2C%2C-1%7CHomeAPers%2C%2C-1%7CPremiumMobPers%2C%2C-1%7CRCSess%2C%2C-1%7CLaFourchette+MC+Banners%2C%2C-1%7CRestAdsCCSess%2C%2C-1%7CRestPremRPers%2C%2C-1%7CRevHubRMPers%2C%2C-1%7CUVOwnersPers%2C%2C-1%7Csh%2C%2C-1%7Cpssamex%2C%2C-1%7CTheForkMCCSess%2C%2C-1%7CCYLPers%2C%2C-1%7CCCPers%2C%2C-1%7Ctvpers%2C%2C-1%7Cb2bmcsess%2C%2C-1%7CSPMCPers%2C%2C-1%7CRevHubRMSess%2C%2C-1%7CPremRetSess%2C%2C-1%7CViatorMCSess%2C%2C-1%7CPremiumMCPers%2C%2C-1%7CAdsRetSess%2C%2C-1%7CPremiumRRPers%2C%2C-1%7CRestAdsCCPers%2C%2C-1%7CTADORPers%2C%2C-1%7CTheForkORPers%2C%2C-1%7CPremMCBtmPers%2C%2C-1%7CTheForkRRPers%2C%2C-1%7CTARSWBSess%2C%2C-1%7CPremiumORPers%2C%2C-1%7CRestAdsSess%2C%2C-1%7CRBASess%2C%2C-1%7CSPORPers%2C%2C-1%7Cperssticker%2C%2C-1%7CSPMCWBSess%2C%2C-1%7C; TAReturnTo=%1%%2FAirline_Review-d8729060-Reviews-Delta-Air-Lines; roybatty=TNI1625!AIBH5WivmwQLLHnyUY%2FZTiEpq%2BOfkSol3T1j16PzoW1VqBR6yaPrLNdc4wDaf%2Bwos5%2BLBpD4KtDiq4v3in%2BI%2FlqXsFEameXwmkQUcvl9A5sf2DXqTWp4lzDpN7squYchnHWgB5zfTBrNAEPwG%2F1tsL%2FacVJg6yMcVW%2Fxz%2F2%2BwpRh%2C1; TASession=V2ID.238E1A99E3396899FAD6EF87ADAD9D27*SQ.82*LS.DemandLoadAjax*GR.42*TCPAR.42*TBR.61*EXEX.45*ABTR.91*PHTB.98*FS.6*CPU.24*HS.recommended*ES.popularity*DS.5*SAS.popularity*FPS.oldFirst*LF.en*FA.1*DF.0*IR.3*OD.en_UK*TRA.false*LD.8729060; TAUD=LA-1576625194436-1*RDD-1-2019_12_17*HC-400655150*HDD-438028237-2020_01_05.2020_01_06*LG-833009317-2.1.F.*LD-833009318-.....',},
                                body=self.payload,
                                callback=self.parse,

            )
